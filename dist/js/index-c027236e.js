import{g as je,i as ze,E as q,a as ue,k as ge,h as pe,c as re}from"./element-plus-28eabd23.js";import{_ as H,d as ce,h as K,e as fe}from"./index-5de9982a.js";import{d as oe,e as k,f as ne,o as g,c as y,U as r,M as _,C as Ce,a as t,P as w,R as M,K as V,aj as J,u as d,Q as C,S as A,L as D,a3 as N,E as _e,a0 as we,an as he,T as Be,a6 as de,n as ye,ad as Ee,J as I,w as se,i as Ie}from"./@vue-293b3db8.js";import{_ as te}from"./_plugin-vue_export-helper-c27b6911.js";import{u as $e}from"./vue-router-3c7b10bc.js";import{M as ae}from"./md-editor-v3-68fe6554.js";import{c as Le}from"./@vueuse-9d87eeea.js";const Te={"[嘿嘿]":"😀","[嘻嘻]":"😁","[笑哭了]":"😂","[笑得满地打滚]":"🤣","[笑脸]":"😃","[笑脸和睁眼]":"😄","[尴尬的笑]":"😅","[坏笑]":"😆","[眨眼笑]":"😉","[微笑]":"😊","[舌头]":"😋","[墨镜]":"😎","[色迷迷的笑]":"😍","[飞吻]":"😘","[亲吻]":"😗","[微笑亲亲]":"😙","[闭眼亲吻]":"😚","[标准]":"🙂","[拥抱]":"🤗","[星星眼]":"🤩","[思考]":"🤔","[皱眉]":"🤨","[表情中立的]":"😐","[无语]":"😑","[无表情的]":"😶","[翻白眼]":"🙄","[得意]":"😏","[困惑]":"😣","[忧伤]":"😥","[吃惊]":"😮","[闭嘴]":"🤐","[震惊]":"😯","[困倦]":"😪","[累]":"😫","[睡觉]":"😴","[安心]":"😌","[吐舌]":"😛","[眨眼吐舌]":"😜","[闭眼吐舌]":"😝","[流口水]":"🤤","[不高兴]":"😒","[冷汗]":"😓","[沮丧]":"😔","[困扰]":"😕","[倒转]":"🙃","[贪婪]":"🤑","[大惊小怪]":"😲","[不满]":"☹","[悲伤]":"🙁","[痛苦]":"😖","[失望]":"😞","[担心]":"😟","[傲慢]":"😤","[伤心]":"😢","[哭]":"😭","[啊]":"😦","[焦虑]":"😧","[害怕]":"😨","[紧张]":"😩","[脑袋爆炸]":"🤯","[龇牙]":"😬","[恐惧]":"😰","[尖叫]":"😱","[尴尬]":"😳","[疯狂]":"🤪","[晕倒]":"😵","[愤怒]":"😡","[生气]":"😠","[咒骂]":"🤬","[口罩]":"😷","[生病]":"🤒","[受伤]":"🤕","[恶心]":"🤢","[呕吐]":"🤮","[打喷嚏]":"🤧","[天使]":"😇","[牛仔帽]":"🤠","[小丑]":"🤡","[撒谎]":"🤥","[安静]":"🤫","[偷笑]":"🤭","[凝视]":"🧐","[书呆子]":"🤓","[恶魔]":"😈","[生气恶魔]":"👿","[大耳朵恶魔]":"👹","[长鼻恶魔]":"👺","[骷髅]":"💀","[鬼魂]":"👻","[外星人]":"👽","[外星怪物]":"👾","[机器人]":"🤖","[大便]":"💩","[笑猫]":"😺","[眯眼笑猫]":"😸","[笑哭猫]":"😹","[爱心猫]":"😻","[坏笑猫]":"😼","[亲亲猫]":"😽","[惊恐猫]":"🙀","[伤心猫]":"😿","[气愤猫]":"😾","[捂眼猴子]":"🙈","[捂耳猴子]":"🙉","[捂嘴猴子]":"🙊"},le={"[3d眼镜]":"https://image.kuailemao.xyz/blog/emoji/heo/3d眼镜.png","[beluga]":"https://image.kuailemao.xyz/blog/emoji/heo/beluga.png","[EDG]":"https://image.kuailemao.xyz/blog/emoji/heo/EDG.png","[LPL]":"https://image.kuailemao.xyz/blog/emoji/heo/LPL.png","[不好意思]":"https://image.kuailemao.xyz/blog/emoji/heo/不好意思.png","[不服吗]":"https://image.kuailemao.xyz/blog/emoji/heo/不服吗.png","[亲亲]":"https://image.kuailemao.xyz/blog/emoji/heo/亲亲.png","[伞兵]":"https://image.kuailemao.xyz/blog/emoji/heo/伞兵.png","[倚墙笑]":"https://image.kuailemao.xyz/blog/emoji/heo/倚墙笑.png","[值得肯定]":"https://image.kuailemao.xyz/blog/emoji/heo/值得肯定.png","[偷偷看]":"https://image.kuailemao.xyz/blog/emoji/heo/偷偷看.png","[傻笑]":"https://image.kuailemao.xyz/blog/emoji/heo/傻笑.png","[再见]":"https://image.kuailemao.xyz/blog/emoji/heo/再见.png","[出家人]":"https://image.kuailemao.xyz/blog/emoji/heo/出家人.png","[击剑]":"https://image.kuailemao.xyz/blog/emoji/heo/击剑.png","[加班]":"https://image.kuailemao.xyz/blog/emoji/heo/加班.png","[勉强笑]":"https://image.kuailemao.xyz/blog/emoji/heo/勉强笑.png","[危险]":"https://image.kuailemao.xyz/blog/emoji/heo/危险.png","[发红包]":"https://image.kuailemao.xyz/blog/emoji/heo/发红包.png","[吃手]":"https://image.kuailemao.xyz/blog/emoji/heo/吃手.png","[吃瓜]":"https://image.kuailemao.xyz/blog/emoji/heo/吃瓜.png","[吐血]":"https://image.kuailemao.xyz/blog/emoji/heo/吐血.png","[吵架]":"https://image.kuailemao.xyz/blog/emoji/heo/吵架.png","[呦吼]":"https://image.kuailemao.xyz/blog/emoji/heo/呦吼.png","[呲牙笑]":"https://image.kuailemao.xyz/blog/emoji/heo/呲牙笑.png","[哈士奇]":"https://image.kuailemao.xyz/blog/emoji/heo/哈士奇.png","[哈士奇失去意识]":"https://image.kuailemao.xyz/blog/emoji/heo/哈士奇失去意识.png","[哈士奇失望]":"https://image.kuailemao.xyz/blog/emoji/heo/哈士奇失望.png","[哭泣]":"https://image.kuailemao.xyz/blog/emoji/heo/哭泣.png","[唱歌]":"https://image.kuailemao.xyz/blog/emoji/heo/唱歌.png","[喜欢]":"https://image.kuailemao.xyz/blog/emoji/heo/喜欢.png","[嘿哈]":"https://image.kuailemao.xyz/blog/emoji/heo/嘿哈.png","[大笑]":"https://image.kuailemao.xyz/blog/emoji/heo/大笑.png","[失去信号]":"https://image.kuailemao.xyz/blog/emoji/heo/失去信号.png","[失望]":"https://image.kuailemao.xyz/blog/emoji/heo/失望.png","[头秃]":"https://image.kuailemao.xyz/blog/emoji/heo/头秃.png","[奋斗]":"https://image.kuailemao.xyz/blog/emoji/heo/奋斗.png","[好奇]":"https://image.kuailemao.xyz/blog/emoji/heo/好奇.png","[好的]":"https://image.kuailemao.xyz/blog/emoji/heo/好的.png","[害羞]":"https://image.kuailemao.xyz/blog/emoji/heo/害羞.png","[小丑]":"https://image.kuailemao.xyz/blog/emoji/heo/小丑.png","[小偷]":"https://image.kuailemao.xyz/blog/emoji/heo/小偷.png","[尬笑]":"https://image.kuailemao.xyz/blog/emoji/heo/尬笑.png","[尴尬]":"https://image.kuailemao.xyz/blog/emoji/heo/尴尬.png","[应援]":"https://image.kuailemao.xyz/blog/emoji/heo/应援.png","[开心]":"https://image.kuailemao.xyz/blog/emoji/heo/开心.png","[引起不适]":"https://image.kuailemao.xyz/blog/emoji/heo/引起不适.png","[微笑]":"https://image.kuailemao.xyz/blog/emoji/heo/微笑.png","[思考]":"https://image.kuailemao.xyz/blog/emoji/heo/思考.png","[恶心]":"https://image.kuailemao.xyz/blog/emoji/heo/恶心.png","[恶魔]":"https://image.kuailemao.xyz/blog/emoji/heo/恶魔.png","[恶魔恐惧]":"https://image.kuailemao.xyz/blog/emoji/heo/恶魔恐惧.png","[惊吓]":"https://image.kuailemao.xyz/blog/emoji/heo/惊吓.png","[惊吓白眼]":"https://image.kuailemao.xyz/blog/emoji/heo/惊吓白眼.png","[惊讶]":"https://image.kuailemao.xyz/blog/emoji/heo/惊讶.png","[惬意]":"https://image.kuailemao.xyz/blog/emoji/heo/惬意.png","[感动]":"https://image.kuailemao.xyz/blog/emoji/heo/感动.png","[愤怒]":"https://image.kuailemao.xyz/blog/emoji/heo/愤怒.png","[我看好你]":"https://image.kuailemao.xyz/blog/emoji/heo/我看好你.png","[手机相机]":"https://image.kuailemao.xyz/blog/emoji/heo/手机相机.png","[打咩]":"https://image.kuailemao.xyz/blog/emoji/heo/打咩.png","[打牌]":"https://image.kuailemao.xyz/blog/emoji/heo/打牌.png","[托腮]":"https://image.kuailemao.xyz/blog/emoji/heo/托腮.png","[扶额]":"https://image.kuailemao.xyz/blog/emoji/heo/扶额.png","[抠鼻]":"https://image.kuailemao.xyz/blog/emoji/heo/抠鼻.png","[抬眼镜]":"https://image.kuailemao.xyz/blog/emoji/heo/抬眼镜.png","[拜托]":"https://image.kuailemao.xyz/blog/emoji/heo/拜托.png","[捂嘴笑]":"https://image.kuailemao.xyz/blog/emoji/heo/捂嘴笑.png","[捂脸]":"https://image.kuailemao.xyz/blog/emoji/heo/捂脸.png","[擦汗]":"https://image.kuailemao.xyz/blog/emoji/heo/擦汗.png","[放鞭炮]":"https://image.kuailemao.xyz/blog/emoji/heo/放鞭炮.png","[敬礼]":"https://image.kuailemao.xyz/blog/emoji/heo/敬礼.png","[整理发型]":"https://image.kuailemao.xyz/blog/emoji/heo/整理发型.png","[斗鸡眼]":"https://image.kuailemao.xyz/blog/emoji/heo/斗鸡眼.png","[智慧的眼神]":"https://image.kuailemao.xyz/blog/emoji/heo/智慧的眼神.png","[月饼]":"https://image.kuailemao.xyz/blog/emoji/heo/月饼.png","[有没有搞错]":"https://image.kuailemao.xyz/blog/emoji/heo/有没有搞错.png","[正确]":"https://image.kuailemao.xyz/blog/emoji/heo/正确.png","[没招]":"https://image.kuailemao.xyz/blog/emoji/heo/没招.png","[波吉]":"https://image.kuailemao.xyz/blog/emoji/heo/波吉.png","[泪奔]":"https://image.kuailemao.xyz/blog/emoji/heo/泪奔.png","[流汗微笑]":"https://image.kuailemao.xyz/blog/emoji/heo/流汗微笑.png","[流鼻涕]":"https://image.kuailemao.xyz/blog/emoji/heo/流鼻涕.png","[深思]":"https://image.kuailemao.xyz/blog/emoji/heo/深思.png","[滑稽]":"https://image.kuailemao.xyz/blog/emoji/heo/滑稽.png","[滑稽吃瓜]":"https://image.kuailemao.xyz/blog/emoji/heo/滑稽吃瓜.png","[滑稽喝水]":"https://image.kuailemao.xyz/blog/emoji/heo/滑稽喝水.png","[滑稽奶茶]":"https://image.kuailemao.xyz/blog/emoji/heo/滑稽奶茶.png","[滑稽柠檬]":"https://image.kuailemao.xyz/blog/emoji/heo/滑稽柠檬.png","[滑稽狂汗]":"https://image.kuailemao.xyz/blog/emoji/heo/滑稽狂汗.png","[滑稽被子]":"https://image.kuailemao.xyz/blog/emoji/heo/滑稽被子.png","[烦恼]":"https://image.kuailemao.xyz/blog/emoji/heo/烦恼.png","[熊熊]":"https://image.kuailemao.xyz/blog/emoji/heo/熊熊.png","[熊猫]":"https://image.kuailemao.xyz/blog/emoji/heo/熊猫.png","[熊猫唱歌]":"https://image.kuailemao.xyz/blog/emoji/heo/熊猫唱歌.png","[熊猫喜欢]":"https://image.kuailemao.xyz/blog/emoji/heo/熊猫喜欢.png","[熊猫失望]":"https://image.kuailemao.xyz/blog/emoji/heo/熊猫失望.png","[熊猫意外]":"https://image.kuailemao.xyz/blog/emoji/heo/熊猫意外.png","[熬夜]":"https://image.kuailemao.xyz/blog/emoji/heo/熬夜.png","[爆炸]":"https://image.kuailemao.xyz/blog/emoji/heo/爆炸.png","[牛年进宝]":"https://image.kuailemao.xyz/blog/emoji/heo/牛年进宝.png","[狂热]":"https://image.kuailemao.xyz/blog/emoji/heo/狂热.png","[狗头]":"https://image.kuailemao.xyz/blog/emoji/heo/狗头.png","[狗头围脖]":"https://image.kuailemao.xyz/blog/emoji/heo/狗头围脖.png","[狗头失望]":"https://image.kuailemao.xyz/blog/emoji/heo/狗头失望.png","[狗头意外]":"https://image.kuailemao.xyz/blog/emoji/heo/狗头意外.png","[狗头胖次]":"https://image.kuailemao.xyz/blog/emoji/heo/狗头胖次.png","[狗头花]":"https://image.kuailemao.xyz/blog/emoji/heo/狗头花.png","[狗头草]":"https://image.kuailemao.xyz/blog/emoji/heo/狗头草.png","[猪头]":"https://image.kuailemao.xyz/blog/emoji/heo/猪头.png","[猪头意外]":"https://image.kuailemao.xyz/blog/emoji/heo/猪头意外.png","[生病]":"https://image.kuailemao.xyz/blog/emoji/heo/生病.png","[电话]":"https://image.kuailemao.xyz/blog/emoji/heo/电话.png","[疑问]":"https://image.kuailemao.xyz/blog/emoji/heo/疑问.png","[疼痛]":"https://image.kuailemao.xyz/blog/emoji/heo/疼痛.png","[痛哭]":"https://image.kuailemao.xyz/blog/emoji/heo/痛哭.png","[看穿一切]":"https://image.kuailemao.xyz/blog/emoji/heo/看穿一切.png","[眩晕]":"https://image.kuailemao.xyz/blog/emoji/heo/眩晕.png","[睡觉]":"https://image.kuailemao.xyz/blog/emoji/heo/睡觉.png","[禁言]":"https://image.kuailemao.xyz/blog/emoji/heo/禁言.png","[笑哭]":"https://image.kuailemao.xyz/blog/emoji/heo/笑哭.png","[纠结]":"https://image.kuailemao.xyz/blog/emoji/heo/纠结.png","[绿帽]":"https://image.kuailemao.xyz/blog/emoji/heo/绿帽.png","[缺牙笑]":"https://image.kuailemao.xyz/blog/emoji/heo/缺牙笑.png","[翻白眼]":"https://image.kuailemao.xyz/blog/emoji/heo/翻白眼.png","[老虎意外]":"https://image.kuailemao.xyz/blog/emoji/heo/老虎意外.png","[耍酷]":"https://image.kuailemao.xyz/blog/emoji/heo/耍酷.png","[胡子]":"https://image.kuailemao.xyz/blog/emoji/heo/胡子.png","[菜狗]":"https://image.kuailemao.xyz/blog/emoji/heo/菜狗.png","[菜狗花]":"https://image.kuailemao.xyz/blog/emoji/heo/菜狗花.png","[蒙面滑稽]":"https://image.kuailemao.xyz/blog/emoji/heo/蒙面滑稽.png","[虎年进宝]":"https://image.kuailemao.xyz/blog/emoji/heo/虎年进宝.png","[被打]":"https://image.kuailemao.xyz/blog/emoji/heo/被打.png","[裂开]":"https://image.kuailemao.xyz/blog/emoji/heo/裂开.png","[警告]":"https://image.kuailemao.xyz/blog/emoji/heo/警告.png","[读书]":"https://image.kuailemao.xyz/blog/emoji/heo/读书.png","[财神红包]":"https://image.kuailemao.xyz/blog/emoji/heo/财神红包.png","[超爱]":"https://image.kuailemao.xyz/blog/emoji/heo/超爱.png","[这是啥]":"https://image.kuailemao.xyz/blog/emoji/heo/这是啥.png","[送福]":"https://image.kuailemao.xyz/blog/emoji/heo/送福.png","[送花]":"https://image.kuailemao.xyz/blog/emoji/heo/送花.png","[错误]":"https://image.kuailemao.xyz/blog/emoji/heo/错误.png","[阴险]":"https://image.kuailemao.xyz/blog/emoji/heo/阴险.png","[难以置信]":"https://image.kuailemao.xyz/blog/emoji/heo/难以置信.png","[面具]":"https://image.kuailemao.xyz/blog/emoji/heo/面具.png","[饥渴]":"https://image.kuailemao.xyz/blog/emoji/heo/饥渴.png","[鬼脸]":"https://image.kuailemao.xyz/blog/emoji/heo/鬼脸.png","[黑线]":"https://image.kuailemao.xyz/blog/emoji/heo/黑线.png","[鼓掌]":"https://image.kuailemao.xyz/blog/emoji/heo/鼓掌.png"},Se={class:"emoji-trigger-btn"},Pe={class:"OvO_emojis"},Re=["title","onClick","onMouseenter"],qe={class:"OvO_heo"},Ne=["title","src","onClick","onMouseenter"],Me=["onClick"],Oe={class:"preview-content"},Fe=["src"],Ue={class:"preview-name"},Ae=oe({__name:"EmojiPicker",props:{popoverWidth:{type:Number,default:510}},emits:["select-emoji","operation-complete"],setup(o,{emit:p}){const n=k(!1),m=k(""),j=k({x:0,y:0}),E=k(!1),$=k(""),z=k(""),L=k(null),c=p,i=k(0),u=k(["Emoji","Heo"]),v=k();ne(()=>{v.value&&v.value.children[i.value].classList.add("active")});function T(b){i.value=b;for(let s=0;s<v.value.children.length;s++)v.value.children[s].classList.remove("active");v.value.children[b].classList.add("active"),c("operation-complete")}function f(b){const s=b.currentTarget;s.classList.add("emoji-clicked"),setTimeout(()=>{s.classList.remove("emoji-clicked")},300)}function Q(b,s){f(s),c("select-emoji",b),c("operation-complete")}function ie(b,s,F){L.value&&clearTimeout(L.value),m.value=s,z.value=F,E.value=!1,Y(b),n.value=!0}function X(b,s,F){L.value&&clearTimeout(L.value),$.value=s,z.value=F,E.value=!0,Y(b),n.value=!0}function G(){L.value=setTimeout(()=>{n.value=!1},100)}function Y(b){const s=b.target.getBoundingClientRect();j.value={x:s.left+s.width/2,y:s.top-120}}return(b,s)=>{const F=H,Z=je,U=ze;return g(),y(V,null,[r(U,{placement:"bottom-end",width:o.popoverWidth,trigger:"click","popper-class":"emoji-popover-container"},{reference:_(()=>[Ce(b.$slots,"trigger",{},()=>[t("div",Se,[r(F,{name:"emojis",class:"emoji-icon"}),s[4]||(s[4]=t("span",{class:"emoji-ripple"},null,-1))])],!0)]),default:_(()=>[t("div",{class:"emojis_container",onMousedown:s[3]||(s[3]=w(()=>{},["stop","prevent"]))},[r(Z,null,{default:_(()=>[M(t("div",Pe,[(g(!0),y(V,null,J(d(Te),(S,B)=>(g(),y("div",{key:B,title:B,onClick:w(P=>Q(S,P),["stop"]),onMousedown:s[0]||(s[0]=w(()=>{},["stop","prevent"])),class:"emoji-item",onMouseenter:P=>ie(P,S,B),onMouseleave:G},C(S),41,Re))),128))],512),[[A,i.value===0]]),M(t("div",qe,[t("div",null,[(g(!0),y(V,null,J(d(le),(S,B)=>(g(),y("div",{key:B,class:"emoji-img-wrapper"},[t("img",{title:B,src:S,onClick:P=>Q(B,P),onMouseenter:P=>X(P,S,B),onMouseleave:G},null,40,Ne)]))),128))])],512),[[A,i.value===1]])]),_:1}),t("div",{class:"OvO_options",ref_key:"options",ref:v,onMousedown:s[2]||(s[2]=w(()=>{},["stop","prevent"]))},[(g(!0),y(V,null,J(u.value,(S,B)=>(g(),y("div",{class:"item_emoji",onClick:w(P=>T(B),["stop"]),onMousedown:s[1]||(s[1]=w(()=>{},["stop","prevent"]))},C(S),41,Me))),256))],544)],32)]),_:3},8,["width"]),(g(),D(we,{to:"body"},[M(t("div",{class:"global-emoji-preview",style:_e({left:`${j.value.x}px`,top:`${j.value.y}px`})},[t("div",Oe,[E.value?(g(),y("img",{key:1,src:$.value},null,8,Fe)):(g(),y(V,{key:0},[N(C(m.value),1)],64))]),t("div",Ue,C(z.value),1)],4),[[A,n.value]])]))],64)}}});const ve=te(Ae,[["__scopeId","data-v-ee7383cb"]]),Ve={class:"reply"},De=["placeholder"],He={class:"reply-footer"},Ke={class:"reply-tools"},Ge=oe({__name:"ReplyBox",props:{comment:{type:Object,required:!0},getComments:{type:Function,required:!0},pageSize:{type:Number,required:!0},type:Number,activeCommentId:{type:[Number,null],default:null},setActiveComment:{type:Function,required:!0}},setup(o){const p=$e(),n=o,m=k(),j=k(null);ne(()=>{m.value.addEventListener("focus",function(){m.value.classList.add("active")}),m.value.addEventListener("blur",function(){(n.comment.replyText===""||n.comment.replyText===void 0)&&m.value.classList.remove("active")}),document.addEventListener("mousedown",i=>{const u=document.querySelector(".emoji-popover-container");u&&u.contains(i.target)&&(i.preventDefault(),i.stopPropagation(),setTimeout(()=>{m.value.focus()},10))},!0)});function E(i,u){if(m.value.selectionStart||m.value.selectionStart===0){const v=m.value.selectionStart,T=m.value.selectionEnd,f=m.value.scrollTop;m.value.value=m.value.value.substring(0,v)+i+m.value.value.substring(T,m.value.value.length),f>0&&(m.value.scrollTop=f),m.value.focus(),m.value.selectionStart=v+i.length,m.value.selectionEnd=v+i.length}else m.value.value+=i,m.value.focus();u.replyText=m.value.value}function $(i){if(i.replyText===""||i.replyText===void 0){q.warning("评论内容不能为空");return}const u={type:n.type,typeId:i.typeId,commentContent:i.replyText,parentId:i.parentId==null?i.id:i.parentId,replyId:i.id,replyUserId:i.commentUserId};ce(u).then(v=>{v.code===200?(q.success("回复成功"),v.data&&ue({title:"回复成功",duration:4e3,type:"warning",message:de("i",{style:"color: teal"},v.data)}),i.replyText="",n.getComments(p.params.id,"1",n.pageSize)):v.code===1002&&q.error(v.msg)})}function z(i){n.activeCommentId===n.comment.id&&(E(i,n.comment),ye(()=>{m.value.focus()}))}function L(i){i.stopPropagation(),i.preventDefault(),n.comment.showReplyBox&&(n.setActiveComment(n.comment.id),m.value.focus(),m.value.classList.add("active"))}function c(i){i==null||i.stopPropagation(),setTimeout(()=>{n.comment.showReplyBox&&m.value.focus()},10)}return(i,u)=>{const v=H,T=ge;return g(),D(Be,{name:"el-zoom-in-top"},{default:_(()=>[M(t("div",Ve,[M(t("textarea",{style:{color:"#7B5F69"},ref_key:"myInput",ref:m,"onUpdate:modelValue":u[0]||(u[0]=f=>o.comment.replyText=f),placeholder:"@"+o.comment.commentUserNickname},null,8,De),[[he,o.comment.replyText]]),t("div",He,[t("div",Ke,[r(ve,{ref_key:"emojiPopover",ref:j,"popover-width":510,onSelectEmoji:z,onOperationComplete:c,onMousedown:u[2]||(u[2]=w(()=>{},["stop","prevent"])),onClick:u[3]||(u[3]=w(()=>{},["stop","prevent"]))},{trigger:_(()=>[t("div",{class:"emoji-trigger-btn",onClick:w(L,["stop","prevent"]),onMousedown:u[1]||(u[1]=w(()=>{},["stop","prevent"]))},[r(v,{name:"emojis",class:"emoji-icon"}),u[5]||(u[5]=t("span",{class:"emoji-ripple"},null,-1))],32)]),_:1},512)]),r(T,{type:"danger",plain:"",size:"small",onClick:u[4]||(u[4]=f=>$(o.comment))},{default:_(()=>[...u[6]||(u[6]=[N("发布",-1)])]),_:1})])],512),[[A,o.comment.showReplyBox]])]),_:1})}}});const ke=te(Ge,[["__scopeId","data-v-c2c7d191"]]),We=(o,p)=>K.request({url:"/like/auth/like",method:"post",params:{type:o,typeId:p}}),Je=(o,p)=>K.request({url:"/like/auth/like",method:"delete",params:{type:o,typeId:p}}),Qe=(o,p)=>K.request({url:"/like/whether/like",method:"get",params:{type:o,typeId:p}}),Xe={key:0},Ye={class:"comment_content"},Ze={class:"comment_content_header"},eo={key:0},oo={style:{"font-size":"0.8em",color:"grey"}},to={style:{"font-size":"0.8em",color:"grey"}},io={class:"comment_content_body"},ao={style:{margin:"0.5rem 0"}},lo={class:"replyUserNickname"},no={key:0},mo=oe({__name:"ChildComment",props:{comment:{type:Object,required:!0},authorId:{type:Number,required:!0},showAllChildComments:{type:Boolean,required:!1},likeBtn:{type:Function,required:!0},cancelLikeBtn:{type:Function,required:!0},replyBtn:{type:Function,required:!0},getComments:{type:Function,required:!0},pageSize:{type:Number,required:!0},type:Number,activeCommentId:{type:[Number,null],default:null},setActiveComment:{type:Function,required:!0}},setup(o){return(p,n)=>{const m=pe,j=re,E=H,$=H,z=ke,L=Ee("ChildComment",!0);return g(!0),y(V,null,J(o.comment.childComment,(c,i)=>(g(),y("div",null,[i<1||o.showAllChildComments?(g(),y("div",Xe,[(g(),y("div",{class:"parent_container",key:c.id},[r(m,{shape:"square",size:40,src:c.commentUserAvatar},null,8,["src"]),t("div",Ye,[t("div",Ze,[t("div",null,[t("div",null,C(c.commentUserNickname),1),c.commentUserId===o.authorId?(g(),y("div",eo,[r(j,{size:"small"},{default:_(()=>[...n[0]||(n[0]=[N("作者",-1)])]),_:1})])):I("",!0),t("div",null,C(c.createTime),1)]),t("div",null,[M(r(E,{onClick:u=>o.likeBtn(c),name:"like",style:{cursor:"pointer"}},null,8,["onClick"]),[[A,!c.isLike]]),M(r(E,{onClick:u=>o.cancelLikeBtn(c),name:"like-selected",style:{cursor:"pointer"}},null,8,["onClick"]),[[A,c.isLike]]),t("span",oo,C(c.likeCount),1),r($,{onClick:u=>o.replyBtn(o.comment.childComment,c.id),name:"comment",style:{margin:"0 0.2em 0 0.5rem",cursor:"pointer"}},null,8,["onClick"]),t("span",to,C(c.childCommentCount),1)])]),t("div",io,[t("div",ao,[n[1]||(n[1]=t("span",{style:{"font-weight":"bold"}},"回复",-1)),t("span",lo," @"+C(c.replyUserNickname),1),n[2]||(n[2]=N("： ",-1))]),t("div",null,[r(d(ae),{modelValue:c.commentContent},null,8,["modelValue"])])]),r(z,{type:o.type,comment:c,"get-comments":o.getComments,"page-size":o.pageSize,"active-comment-id":o.activeCommentId,"set-active-comment":o.setActiveComment},null,8,["type","comment","get-comments","page-size","active-comment-id","set-active-comment"])])])),c.childComment&&c.childComment.length?(g(),y("div",no,[r(L,{"reply-btn":o.replyBtn,"like-btn":o.likeBtn,"cancel-like-btn":o.cancelLikeBtn,comment:c,"author-id":o.authorId,"get-comments":o.getComments,"page-size":o.pageSize,type:o.type,"active-comment-id":o.activeCommentId,"set-active-comment":o.setActiveComment},null,8,["reply-btn","like-btn","cancel-like-btn","comment","author-id","get-comments","page-size","type","active-comment-id","set-active-comment"])])):I("",!0)])):I("",!0)]))),256)}}});const so=te(mo,[["__scopeId","data-v-1a85ac25"]]),uo={class:"comments"},go={key:0},po={class:"comments_title"},ro={class:"form_container"},co={class:"btn"},ho={key:0,class:"preview"},yo={style:{display:"flex","margin-top":"1rem","border-top":"1px solid var(--el-border-color)","padding-top":"1rem"}},vo={class:"comment_content"},ko={class:"comment_content_header"},xo={key:0},bo={style:{"font-size":"0.8em",color:"grey"}},jo={style:{"font-size":"0.8em",color:"grey"}},zo={class:"comment_content_body"},fo={key:2,style:{display:"flex","justify-content":"center","margin-top":"1rem"}},Co={key:1,class:"more"},_o=oe({__name:"index",props:{authorId:{type:Number,required:!0},typeId:{type:Number,required:!0},isShowHeader:{type:Boolean,default:!0},type:Number,likeType:Number},setup(o){const p=o,n=k(""),m=k(""),j=k(),E=k(!1),$=k(null);function z(a){$.value=a}function L(a){a.stopPropagation(),a.preventDefault(),i.value&&i.value.forEach(e=>{e.showReplyBox=!1,e.childComment&&e.childComment.length&&Z(e.childComment)}),z(null),j.value.focus()}function c(a){if(!$.value){let e=j.value.selectionStart,l=j.value.selectionEnd;n.value=n.value.substring(0,e)+a+n.value.substring(l,n.value.length),ye(()=>{j.value.focus(),j.value.selectionStart=e+a.length,j.value.selectionEnd=e+a.length})}}const i=k(),u=k(0),v=k(!1),T=k(!1),f=k(2),Q=Le();ne(()=>{U(p.typeId,"1",String(f.value))}),se(()=>n.value,a=>{m.value=X(a)});function ie(a){return X(a)}function X(a){const e=/```[\s\S]*?```/g,l=a.match(e);let h=a;l&&l.forEach((O,R)=>{h=h.replace(O,`{{CODE_BLOCK_${R}}}`)});const W=h.match(/\[[^\]]+\]/g);if(W)for(let O=0;O<W.length;O++){const R=W[O];le[R]&&(h=h.replace(R,`<span><img src="${le[R]}" width="24" height="24" alt="Ruyu-blog-[1231256151315612]" /></span>`))}return l&&l.forEach((O,R)=>{h=h.replace(`{{CODE_BLOCK_${R}}}`,O)}),h}function G(a){a.forEach(e=>{e.commentContent=ie(e.commentContent),e.childComment&&e.childComment.length&&G(e.childComment)})}const Y=()=>{U(p.typeId,"1",String(f.value+=3))};function b(a,e){e.data.forEach(l=>{a.forEach(h=>{h.id===l.typeId&&(h.isLike=!0),h.childComment&&h.childComment.length&&b(h.childComment,e)})})}function s(a,e){a.forEach(l=>{l.id===e?(l.showReplyBox?z(null):z(e),l.showReplyBox=!l.showReplyBox):l.showReplyBox=!1,l.childComment&&l.childComment.length&&F(l.childComment,e)})}function F(a,e){a.forEach(l=>{l.id===e?(l.showReplyBox?z(null):z(e),l.showReplyBox=!l.showReplyBox):l.showReplyBox=!1,l.childComment&&l.childComment.length&&F(l.childComment,e)})}function Z(a){a.forEach(e=>{e.showReplyBox=!1,e.childComment&&e.childComment.length&&Z(e.childComment)})}se(()=>p.typeId,a=>{U(a,"1",String(f.value))});function U(a,e,l){fe(p.type,a,e,l).then(h=>{h.code==200&&(E.value=!0,i.value=h.data.page,u.value=h.data.total,G(h.data.page),P())})}function S(a){We(p.likeType,a.id).then(e=>{e.code===200?(a.isLike=!0,a.likeCount+=1,q.success("点赞成功")):q.error(e.msg)})}function B(a){Je(p.likeType,a.id).then(e=>{e.code===200?(a.isLike=!1,a.likeCount-=1,q.info("取消点赞")):q.error(e.msg)})}function P(){Qe(p.likeType).then(a=>{a.code===200&&a.data.forEach(e=>{i.value.forEach(l=>{l.id===e.typeId&&(l.isLike=!0),l.childComment&&l.childComment.length&&b(l.childComment,a)})})})}function xe(){if(n.value===""){q.error("评论内容不能为空");return}let a={type:p.type,typeId:p.typeId,commentContent:n.value};ce(a).then(e=>{e.code===200?(q.success("评论成功"),e.data&&ue({title:"评论成功",duration:4e3,type:"warning",message:de("i",{style:"color: teal"},e.data)}),n.value="",U(p.typeId,"1",String(f.value))):e.code===1002&&q.error(e.msg)})}return(a,e)=>{var me;const l=H,h=ge,W=pe,O=re,R=H,be=ke;return g(),y("div",uo,[o.isShowHeader?(g(),y("div",go,[t("div",po,[r(l,{name:"comment",width:"1.5em",height:"1.5em"}),t("span",null,"评论("+C(d(u))+")",1)]),t("div",ro,[M(t("textarea",{ref_key:"myInput",ref:j,class:"textarea","onUpdate:modelValue":e[0]||(e[0]=x=>Ie(n)?n.value=x:null),placeholder:"留下你的精彩评论吧！"},null,512),[[he,d(n)]]),t("div",co,[t("div",null,[r(ve,{"popover-width":510,onSelectEmoji:c,onMousedown:e[2]||(e[2]=w(()=>{},["stop"])),onClick:e[3]||(e[3]=w(()=>{},["stop"]))},{trigger:_(()=>[t("div",{class:"emoji-trigger-btn",onClick:w(L,["stop"]),onMousedown:e[1]||(e[1]=w(()=>{},["stop"]))},[r(l,{name:"emojis",class:"emoji-icon"})],32)]),_:1})]),t("div",null,[r(h,{type:"info",plain:"",size:"small",onClick:e[4]||(e[4]=x=>v.value=!d(v))},{default:_(()=>[...e[7]||(e[7]=[N("预览",-1)])]),_:1}),r(h,{type:"success",plain:"",size:"small",onClick:xe},{default:_(()=>[...e[8]||(e[8]=[N("发布",-1)])]),_:1})])]),d(v)?(g(),y("div",ho,[r(d(ae),{modelValue:d(m),theme:d(Q)},null,8,["modelValue","theme"])])):I("",!0)])])):I("",!0),t("div",null,[(g(!0),y(V,null,J(d(i),x=>(g(),y("div",yo,[r(W,{shape:"square",size:40,src:x.commentUserAvatar},null,8,["src"]),t("div",vo,[t("div",ko,[t("div",null,[t("div",null,C(x.commentUserNickname),1),x.commentUserId===o.authorId?(g(),y("div",xo,[r(O,{size:"small"},{default:_(()=>[...e[9]||(e[9]=[N("作者",-1)])]),_:1})])):I("",!0),t("div",null,C(x.createTime),1)]),t("div",null,[M(r(R,{onClick:ee=>S(x),name:"like",style:{cursor:"pointer"}},null,8,["onClick"]),[[A,!x.isLike]]),M(r(R,{onClick:ee=>B(x),name:"like-selected",style:{cursor:"pointer"}},null,8,["onClick"]),[[A,x.isLike]]),t("span",bo,C(x.likeCount),1),r(l,{onClick:ee=>s(d(i),x.id),name:"comment",style:{margin:"0 0.2em 0 0.5rem",cursor:"pointer"}},null,8,["onClick"]),t("span",jo,C(x.childCommentCount),1)])]),t("div",zo,[t("div",null,[r(d(ae),{modelValue:x.commentContent},null,8,["modelValue"])])]),d(E)?(g(),D(be,{key:0,type:o.type,comment:x,"get-comments":U,"page-size":d(f),"active-comment-id":d($),"set-active-comment":z},null,8,["type","comment","page-size","active-comment-id"])):I("",!0),x.childComment&&x.childComment.length?(g(),D(so,{key:1,"reply-btn":s,"like-btn":S,"cancel-like-btn":B,comment:x,"author-id":o.authorId,"show-all-child-comments":d(T),"get-comments":U,"page-size":d(f),type:o.type,"active-comment-id":d($),"set-active-comment":z},null,8,["comment","author-id","show-all-child-comments","page-size","type","active-comment-id"])):I("",!0),x.childCommentCount>=2?(g(),y("div",fo,[d(T)?I("",!0):(g(),D(h,{key:0,type:"info",plain:"",size:"small",onClick:e[5]||(e[5]=ee=>T.value=!0)},{default:_(()=>[N(" 查看全部"+C(x.childCommentCount)+"条回复 ",1)]),_:2},1024)),d(T)?(g(),D(h,{key:1,type:"info",plain:"",size:"small",onClick:e[6]||(e[6]=ee=>T.value=!1)},{default:_(()=>[...e[10]||(e[10]=[N(" 收起回复 ",-1)])]),_:1})):I("",!0)])):I("",!0)])]))),256))]),d(E)&&((me=d(i)[0])==null?void 0:me.parentCommentCount)>=d(f)?(g(),y("div",Co,[r(h,{type:"info",plain:"",size:"small",onClick:Y},{default:_(()=>[...e[11]||(e[11]=[N("查看更多",-1)])]),_:1})])):I("",!0)])}}});const So=te(_o,[["__scopeId","data-v-a4b12752"]]),Po=(o,p)=>K.request({url:"/favorite/auth/favorite",method:"post",params:{type:o,typeId:p}}),Ro=(o,p)=>K.request({url:"/favorite/auth/favorite",method:"delete",params:{type:o,typeId:p}}),qo=(o,p)=>K.request({url:"/favorite/whether/favorite",method:"get",params:{type:o,typeId:p}});export{So as _,qo as a,Po as b,Je as c,Ro as d,Qe as i,We as u};
