import{E as d,y as B,z as N,m as P,p as A,q as T,w as Z,k as F,x as M,r as j,n as D}from"./element-plus-28eabd23.js";import{H as G,I as H,G as b}from"./@element-plus-51afdc8f.js";import{s as J}from"./index-615793b3.js";import{j as L,k as O}from"./index-5de9982a.js";import{b as Q}from"./vue-router-3c7b10bc.js";import{d as K,e as w,V as W,l as X,o as x,c as v,a as r,U as t,M as o,u as s,a3 as c,Q as Y,J as z}from"./@vue-293b3db8.js";import"./dayjs-6997e6a6.js";import"./copy-to-clipboard-55affb02.js";import"./toggle-selection-93f4ad84.js";import"./lodash-es-327b7962.js";import"./async-validator-dee29e8b.js";import"./@ctrl-f8748455.js";import"./@popperjs-c75af06c.js";import"./@vueuse-9d87eeea.js";import"./pinia-b73abff6.js";import"./vue-demi-71ba0ef2.js";import"./axios-b5ee139b.js";import"./nprogress-b52be870.js";import"./@codemirror-b3ba2dcc.js";import"./@lezer-5d82abd9.js";import"./crelt-7bb88e1d.js";import"./@marijn-45184d7f.js";import"./style-mod-ab9c37a6.js";import"./w3c-keyname-9fb136d3.js";const ee={style:{"text-align":"center"}},te={style:{"margin-top":"30px"}},oe={key:0,style:{margin:"0 20px"}},se={style:{"margin-top":"50px"}},le={style:{"margin-top":"80px"}},re={key:1,style:{margin:"0 20px"}},ae={style:{"margin-top":"50px"}},ie={style:{"margin-top":"80px"}},ne={style:{"margin-top":"20px"}},Ne=K({__name:"index",setup(pe){const C=Q(),m=w(0),n=w(0),u=w(),l=W({email:"",code:"",password:"",password_repeat:""}),V={password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"密码的长度必须在 6-20 个字符之间",trigger:["blur","change"]}],password_repeat:[{validator:(a,e,p)=>{e===""?p(new Error("请再次输入密码")):e!==l.password?p(new Error("两次输入的密码不一致")):p()},trigger:["blur","change"]}],email:[{required:!0,message:"请输入邮件地址",trigger:"blur"},{type:"email",message:"请输入合法的电子邮件地址",trigger:["blur","change"]}],code:[{required:!0,message:"请输入获取的验证码",trigger:"blur"}]};function R(){E?(n.value=60,J(l.email,"reset").then(a=>{a.code===200?(d.success(`验证码已发送到邮箱：${l.email}，请注意查收`),setInterval(()=>n.value--,1e3)):(d.warning(a.msg),n.value=0)})):d.warning("请输入正确的电子邮件")}const E=X(()=>/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(l.email));function I(){u.value.validate(a=>{a&&L(l).then(e=>{e.code===200?(console.log(e),m.value++):d.warning(e.msg)})})}function S(){u.value.validate(a=>{a&&O(l).then(e=>{e.code===200?(d.success("密码重置成功，请重新登录"),C.push("/login")):d.warning(e.msg)})})}return(a,e)=>{const p=B,U=N,f=P,_=A,g=T,k=Z,y=F,$=M,h=j,q=D;return x(),v("div",ee,[r("div",te,[t(U,{"align-center":"",active:s(m),"finish-status":"success"},{default:o(()=>[t(p,{title:"验证电子邮件"}),t(p,{title:"重写设定密码"})]),_:1},8,["active"])]),s(m)===0?(x(),v("div",oe,[e[6]||(e[6]=r("div",{style:{"margin-top":"80px"}},[r("div",{style:{"font-size":"25px","font-weight":"bold"}},"重置密码"),r("div",{style:{"font-size":"14px",color:"grey","margin-top":"1rem"}},"请输入需要重置密码的电子邮件地址")],-1)),r("div",se,[t(h,{model:s(l),rules:V,ref_key:"formRef",ref:u},{default:o(()=>[t(g,{prop:"email"},{default:o(()=>[t(_,{modelValue:s(l).email,"onUpdate:modelValue":e[0]||(e[0]=i=>s(l).email=i),type:"email",placeholder:"电子邮件地址"},{prefix:o(()=>[t(f,null,{default:o(()=>[t(s(G))]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(g,{prop:"code"},{default:o(()=>[t($,{gutter:10,style:{width:"100%"}},{default:o(()=>[t(k,{span:17},{default:o(()=>[t(_,{modelValue:s(l).code,"onUpdate:modelValue":e[1]||(e[1]=i=>s(l).code=i),maxlength:"6",placeholder:"请输入验证码"},{prefix:o(()=>[t(f,null,{default:o(()=>[t(s(H))]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(k,{span:5},{default:o(()=>[t(y,{type:"success",onClick:R,disabled:!s(E)||s(n)>0},{default:o(()=>[c(Y(s(n)>0?`请稍后 ${s(n)} 秒`:"获取验证码"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),r("div",le,[t(y,{onClick:I,type:"warning",style:{width:"270px"},plain:""},{default:o(()=>[...e[5]||(e[5]=[c("开始重置密码",-1)])]),_:1})])])):z("",!0),s(m)===1?(x(),v("div",re,[e[8]||(e[8]=r("div",null,[r("div",{style:{"margin-top":"80px"}},[r("div",{style:{"font-size":"25px","font-weight":"bold"}},"重置密码"),r("div",{style:{"font-size":"14px",color:"grey","margin-top":"1rem"}},"请填写你的新密码，务必牢记，防止丢失")])],-1)),r("div",ae,[t(h,{model:s(l),rules:V,ref_key:"formRef",ref:u},{default:o(()=>[t(g,{prop:"password"},{default:o(()=>[t(_,{modelValue:s(l).password,"onUpdate:modelValue":e[2]||(e[2]=i=>s(l).password=i),maxlength:"20",type:"password",placeholder:"密码"},{prefix:o(()=>[t(f,null,{default:o(()=>[t(s(b))]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(g,{prop:"password_repeat"},{default:o(()=>[t(_,{modelValue:s(l).password_repeat,"onUpdate:modelValue":e[3]||(e[3]=i=>s(l).password_repeat=i),maxlength:"20",type:"password",placeholder:"重复密码"},{prefix:o(()=>[t(f,null,{default:o(()=>[t(s(b))]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),r("div",ie,[t(y,{type:"danger",style:{width:"270px"},plain:"",onClick:S},{default:o(()=>[...e[7]||(e[7]=[c("立即重置密码",-1)])]),_:1})])])):z("",!0),r("div",ne,[e[10]||(e[10]=r("span",{style:{"font-size":"14px","line-height":"15px",color:"grey"}},"改变注意?",-1)),t(q,{style:{translate:"0 -1px"},onClick:e[4]||(e[4]=i=>a.$router.push("/login"))},{default:o(()=>[...e[9]||(e[9]=[c("返回登录",-1)])]),_:1})])])}}});export{Ne as default};
